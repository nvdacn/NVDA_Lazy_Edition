# NVDA 懒人版

本程序基于 NVDA 官方版程序创建，主要修改了个别比较影响简体中文用户使用的选项，集成了部分较常用的插件和语音等。具体介绍如下：

## 对于设置选项的修改

- 常规设置：将“更新镜像”的网址设置为[中文社区的镜像地址](https://api.nvaccess.mirror.nvdadr.com/nvdaUpdateCheck)，以解决某些网络无法正常下载 NVDA 更新的问题；
- 语音设置：关闭 eSpeak NG、 Microsoft Speech API version 4、 Microsoft Speech API version 5、 Windows OneCore、AiSound5、WorldVoice 等接口的“激活拼读功能”选项，以避免出现个别字符发音怪异的现象；
- 输入法设置：关闭“自动读出所有可用的候选”，以避免中文输入过程中对所有候选字的连续朗读，干扰输入；
- 对象查看设置：启用“读出工具提示”，用以自动读出文件大小等信息；
- 浏览模式设置：关闭“页面加载完成后朗读所有内容”，避免影响操作；
- 文档格式设置：关闭“表格的单元坐标”，以避免过于冗余的朗读，此选项如有需要，可考虑临时启用，或为特定程序创建专用配置；
- 远程访问设置：启用“启用远程访问”，用以更方便的获取他人协助；
- 插件商店设置：将“镜像服务器”的网址设置为[中文社区的插件商店镜像地址](https://addonstore.nvaccess.mirror.nvdadr.com)，以解决某些网络无法正常访问插件商店或通过商店下载插件的问题；
- 高级设置：将“Windows 控制台支持”更改为“UIA 如果可用”、启用“在所有的增强终端读出密码”、将“Diff 算法”更改为“允许 Diff Match Patch”，以解决 CMD 等命令行程序在某些情况下的字符重复朗读等问题；
- WorldVoice 插件：禁用 ESpeak 语音引擎，启用“检测语言时忽略数字和常见的标点符号”，将“语音”更改为“Ting-Ting”、“音量”更改为“80”、“数字语言”更改为“中文(简体，中国)”、“数字模式”更改为“数值”，使此插件更加易用，特别感谢 Eureka 提供数据；
- 及时翻译插件：启用“使用镜像（适用于中文社区用户）”，使此插件更加易用。

上述设置在安装程序的“选择组件”页面，选择“默认安装”、“完整安装”或“最小安装”时均会自动应用，如选择自定义安装，需选中“修改部分 NVDA 设置”复选框方可成功应用。
为了避免误操作，造成您原有设置的丢失，故如检测到您的 NVDA 用户配置文件夹存在“NVDA.ini”文件，程序将不会自动选择上述选项，如仍要应用这些配置，需在“选择组件”页面选择“自定义安装”并选中“修改部分 NVDA 设置”复选框才可。

## 集成的语音引擎

本程序增加了一些语音引擎共安装和使用，具体如下：

- VVTTS 语音引擎
- AiSound5 语音引擎
- WorldVoice 语音（默认安装）

上述标有“默认安装”的语音引擎及所需运行库，在安装程序的“选择组件”页面，选择“默认安装”时会自动安装，其他语音引擎需选择“完整安装”才会被自动安装，亦可选择“自定义安装”进行选择性安装。

## 常用插件的集成

本程序内含一些比较常用的插件，具体包括：

- Access8Math
- 插件文档
- 插件管理工具箱
- 音频管理器（仅 Windows 10 及以上版本的系统可见，默认安装）
- 百度翻译（默认安装）
- 剪贴板朗读增强（默认安装）
- DragAndDrop （对象拖放）
- 金色光标（默认安装）
- 中文输入法支持（默认安装）
- 输入锁
- 及时翻译（默认安装）
- 数字处理
- 对象监视器（默认安装）
- PC QQ增强（默认安装）
- 资源监控器（默认安装）
- 取消系统静音
- PC微信增强（默认安装）
- 新翼OCR（默认安装）

上述标有“默认安装”的插件，在安装程序的“选择组件”页面，选择“默认安装”时会自动安装，其他插件需选择“完整安装”才会被自动安装，亦可选择“自定义安装”进行选择性安装。
以上插件的快捷键及使用说明，可查看插件帮助或 NVDA 中文站的相关介绍页面。

## 其他说明

1. 运行本程序时，根据您的 NVDA 配置文件夹中是否存在 NVDA.ini 文件，会弹出不同的欢迎引导对话框，请根据提示选择所需的安装模式亦或者是否清空及是否备份您的现有配置，如选择备份您现有的 NVDA 配置，则备份的文件位于 `"%UserProfile%\Documents\NVDABackup"` 文件夹下；
2. 在本程序的“选择附加任务”页面，还提供了下列附加选项，可按需选择使用：

   - 在欢迎界面启用 NVDA：该选项可控制 NVDA 是否朗读 Windows 登录窗口；
   - 修复音频闪避等功能无法使用：该选项会尝试修复在某些禁用用户账户控制的操作系统 NVDA 的音频闪避、触摸屏等功能无法使用的问题；
   - 语音合成器设置：该选项可设置 NVDA 首次运行时的默认语音引擎；
   - 导入 VVTTS 语音字典（仅用于 SAPI4）：该选项用以解决部分字符在SAPI4 接口的 VVTTS 发音错误或读乱码的问题；
   - 清空用户配置文件夹：该选项用于清空 `"%AppData%\nvda"` 文件夹中的所有内容，默认会在备份后清理。

3. 本程序的压缩包中附带有“NVDA 配置恢复工具.exe”文件，如运行本程序时，您的 NVDA 配置文件夹中存在 NVDA.ini 文件，并且您选择了清空及备份您的现有配置文件，则可通过此程序将其恢复到您的 NVDA 配置文件夹，恢复后的效果与未使用本程序进行安装基本相同，恢复后备份的配置文件即会被删除；
4. 通过本程序安装的 IBM ViaVoice TTS Runtime v6.405 语音引擎、Microsoft Visual C++ 2012 Redistributable (x86) 等组件，无法被自动删除，如需删除，请到程序和功能自行卸载；
5. 本程序的界面消息仅支持以简体中文显示，当检测到本程序在其他语言的操作系统上运行时，为了避免其他语言的语音引擎无法识别简体中文，进而导致本程序无法顺利安装，故将会以英语显示一个错误对话框，可根据对话框提示启动原始 NVDA 安装流程，本程序对简体中文用户定制的设置、插件等个性化功能将不会安装。

## 主要贡献者

本程序的主要贡献者如下：

- wmhn1872265132（开发和测试）
- hwf1324（GitHub Actions 自动化构建流程）
- cary-rowen（版本维护及中文站上传）
