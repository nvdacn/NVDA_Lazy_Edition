name: Release new version

on:
  workflow_dispatch:
    inputs:
      beta_Version:
        description: 'beta version'
        type: boolean
        required: true

jobs:
  Create-Tag:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6
        with:
          fetch-depth: 0
          ref: master
          ssh-key: ${{ secrets.PUSH_SSH_PRIVATE_KEY }}
          fetch-tags: true
      - name: Create tag
        run: |
          export TZ='Asia/Shanghai'
          echo "Current time: $(date)"
          DATE=$(date +'%Y.%m.%d')
          TAG="$DATE"
          if [[ "${{ github.event.inputs.beta_Version }}" == "true" ]]; then
            TAG="${DATE}(beta)"
          fi
          git tag $TAG
          git push origin $TAG
